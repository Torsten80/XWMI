Changelog:

20220109
- new variant of the wrapper script because of security concerns (wmiquery_alternative.sh).
In the old variant, users can see the password used by observing the processes with ps (so encpass encryption does nothing).
Here the password is passed to wmiquery.py via an environment variable.
However, wmiquery.py must be modified for this:

before line 183 password = os.environ['wmipw'] must be inserted:

password = os.environ['wmipw']

if password == '' and username != '' and options.hashes is None and options.no_pass is False and options.aesKey is None:
        from getpass import getpass
        password = getpass("Password:")


All other changes are documented in the respective script!

Translated with www.DeepL.com/Translator (free version)